<div class="m-auto p-10 py-0 min-h-[calc(100vh-72px)] flex max-md:p-8 max-md:py-0">
  <div class="flex flex-col gap-[10px]">
    <nav class="text-[20px] ml-[100px]">
      <button
        class="cursor-pointer relative transition-all duration-[0.3s] ease-[ease-in-out] hover:text-[#6E594BFF] before:content-[''] before:absolute before:opacity-0 before:bottom-[-5px] before:w-0 before:h-0.5 before:border before:transition-all before:duration-[0.3s] before:ease-[ease-in-out] before:border-solid before:border-[#6E594BFF] before:left-0 hover:before:w-full hover:before:opacity-[100%]"
        (click)="goHome()"
      >
        Home
      </button>
      /
      <button
        class="cursor-pointer relative transition-all duration-[0.3s] ease-[ease-in-out] hover:text-[#6E594BFF] before:content-[''] before:absolute before:opacity-0 before:bottom-[-5px] before:w-0 before:h-0.5 before:border before:transition-all before:duration-[0.3s] before:ease-[ease-in-out] before:border-solid before:border-[#6E594BFF] before:left-0 hover:before:w-full hover:before:opacity-[100%] disabled:pointer-events-none"
        (click)="goCatalog()"
        [disabled]="currentPage === 'Catalog'"
      >
        Catalog
      </button>
      @if (currentType) {
        /
        <button
          class="cursor-pointer relative transition-all duration-[0.3s] ease-[ease-in-out] hover:text-[#6E594BFF] before:content-[''] before:absolute before:opacity-0 before:bottom-[-5px] before:w-0 before:h-0.5 before:border before:transition-all before:duration-[0.3s] before:ease-[ease-in-out] before:border-solid before:border-[#6E594BFF] before:left-0 hover:before:w-full hover:before:opacity-[100%] disabled:pointer-events-none"
          (click)="showProductsFromType(currentType, currentTypeID)"
          [disabled]="currentPage === currentType"
        >
          {{ currentType }}
        </button>
      }
      @if (currentCategory) {
        /
        <button
          class="relative transition-all duration-[0.3s] ease-[ease-in-out] hover:text-[#6E594BFF] before:content-[''] before:absolute before:opacity-0 before:bottom-[-5px] before:w-0 before:h-0.5 before:border before:transition-all before:duration-[0.3s] before:ease-[ease-in-out] before:border-solid before:border-[#6E594BFF] before:left-0 hover:before:w-full hover:before:opacity-[100%] pointer-events-none"
        >
          {{ currentCategory }}
        </button>
      }
    </nav>
    <h1 class="title-h1 leading-[60px] text-[40px] ml-[100px]">{{ currentPage }}</h1>

    @if (currentPage === 'Catalog') {
      <div class="flex flex-col gap-5 ml-[100px]">
        @for (type of types; track type) {
          <div class="flex gap-[30px] text-[#222] p-8 border border-solid border-[#e3e3e3]">
            <img
              [src]="`/webp/${type.name}.webp`"
              alt="{{ type.name }}"
              class="h-[100px] w-[100px] object-contain"
            />
            <div class="flex flex-col text-left">
              <button
                class="text-[25px] text-left mb-[15px] cursor-pointer relative transition-all duration-[0.3s] ease-[ease-in-out] hover:text-[#6E594BFF] before:content-[''] before:absolute before:opacity-0 before:bottom-[-5px] before:w-0 before:h-0.5 before:border before:transition-all before:duration-[0.3s] before:ease-[ease-in-out] before:border-solid before:border-[#6E594BFF] before:left-0 hover:before:w-full hover:before:opacity-[100%]"
                (click)="showProductsFromType(`${type.name}`,`${type.id}`)"
              >
                {{ type.name }}
              </button>
              @if (type.name === 'Coffee') {
                @for (category of categories; track category) {
                  <button
                    class="text-left mb-[10px] cursor-pointer relative transition-all duration-[0.3s] ease-[ease-in-out] hover:text-[#6E594BFF] before:content-[''] before:absolute before:opacity-0 before:bottom-[-5px] before:w-0 before:h-0.5 before:border before:transition-all before:duration-[0.3s] before:ease-[ease-in-out] before:border-solid before:border-[#6E594BFF] before:left-0 hover:before:w-full hover:before:opacity-[100%]"
                    (click)="showProductsFromCategory(`${category.name['en-US']}`, `${category.id}`)"
                  >
                    {{ category.name['en-US'] }}
                  </button>
                }
              }
            </div>
          </div>
        }
      </div>
    }

    @if (currentPage !== 'Catalog') {
      <div class="w-full p-5 controls">
        <div class="w-full p-5 grid grid-cols-[2.5fr_1fr_1fr_1fr] gap-3">
          @if (currentType === 'Coffee' && types[0]) {
            <div [formGroup]="Attributes" class="grid grid-cols-3 gap-3">
              @for (key of types[0].attributes.slice(0, 3); track key) {
                <p class="capitalize flex flex-col items-start">
                  <span class="text-[#6E594BFF] ml-[10px]">{{ key.name }}:</span>
                  <span>
                    <ul class="flex flex-col items-start">
                      @for (value of key.type.values; track value) {
                        <li>
                          <mat-checkbox
                            formControlName="{{ key.name }}.key:&quot;{{ value.key }}&quot;"
                            >{{ value.label }}</mat-checkbox
                          >
                        </li>
                      }
                    </ul>
                  </span>
                </p>
              }
            </div>
          }

          <div [formGroup]="priceRange" class="flex flex-wrap w-[156px] h-[70px]">
            <span class="text-[#6E594BFF]">Price range:</span>
            <label for="sliderStart" class="example-value-label w-[50%] h-[20px] text-left"
              >${{ sliderStart.value }}</label
            >
            <label for="sliderEnd" class="example-value-label w-[50%] h-[20px]"
              >${{ sliderEnd.value }}</label
            >
            <mat-slider min="0" max="100.00" step="0.10">
              <input value="0" formControlName="sliderStart" matSliderStartThumb #sliderStart />
              <input value="100.00" formControlName="sliderEnd" matSliderEndThumb #sliderEnd />
            </mat-slider>
          </div>

          <div class="h-[80px] flex flex-col justify-between">
            <button
              (click)="checkFilters()"
              class="text-[#f8e4be] p-0.5 rounded-[5px] w-[120px] bg-[#6E594BFF] cursor-pointer transition-all duration-[0.3s] ease-[ease-out] hover:bg-[#795f53]"
            >
              Apply filters
            </button>
            <button
              (click)="resetFilters()"
              class="text-[#f8e4be] p-0.5 rounded-[5px] w-[120px] bg-[#6E594BFF] cursor-pointer transition-all duration-[0.3s] ease-[ease-out] hover:bg-[#795f53]"
            >
              Reset filters
            </button>
          </div>
          <div>
            <div>
              <h4>Sort by</h4>
              <mat-form-field class="h-[75px]">
                <mat-select [formControl]="sort" (selectionChange)="sortProducts()">
                  @for (sorter of sorters; track sorter) {
                    <mat-option [value]="sorter.value">{{ sorter.viewValue }}</mat-option>
                  }
                </mat-select>
              </mat-form-field>
            </div>
            <mat-form-field class="h-[75px]">
              <mat-label>Search</mat-label>
              <input matInput type="text" [(ngModel)]="search" (input)="onSearch()" />
              @if (search) {
                <button matSuffix matIconButton aria-label="Clear" (click)="resetSearch()">
                  <mat-icon>close</mat-icon>
                </button>
              }
            </mat-form-field>
          </div>
        </div>
      </div>

      <div class="p-5 grid grid-cols-3 gap-3">
        @for (product of products(); track product.id) {
          <app-product-card [product]="product" />
        }
      </div>
    }
  </div>
</div>
